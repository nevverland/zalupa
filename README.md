# Система управления продукцией (обои)

## Описание проекта

Проект представляет собой приложение для управления продукцией компании, производящей обои. Приложение позволяет просматривать, добавлять и редактировать данные о продукции, а также рассчитывать необходимое количество материалов для производства. Разработано в рамках демонстрационного экзамена по специальности 09.02.07 (Информационные системы и программирование).

### Основные функции:
- Просмотр списка продукции с расчетом стоимости на основе используемых материалов.
- Добавление и редактирование данных о продукции.
- Просмотр списка материалов, необходимых для выбранного продукта.
- Расчет количества материала, необходимого для производства заданного количества продукции.

## Требования и установка

### Требования:
- **Операционная система:** Windows (или любая ОС с установленным Python).
- **Python:** Версия 3.8 или выше.
- **Библиотеки Python:**
  - `tkinter` (встроенная в Python).
  - `sqlite3` (встроенная в Python).
  - `Pillow` (для работы с изображениями).
- **SQLite:** Утилита `sqlite3.exe` для работы с базой данных.
- Графические файлы: `res/logo.png`, `res/icon.ico`.

### Установка:
1. Убедитесь, что Python установлен:
   ```bash
   python --version
   ```
2. Установите библиотеку Pillow:
   ```bash
   pip install Pillow
   ```
3. Скачайте проект из репозитория (например, через `git clone`).
4. Убедитесь, что в папке проекта находятся:
   - Исходные файлы: `main.py`, `material_calc.py`.
   - Скрипты БД: `schema.sql`, `schema2.sql`, `data.sql`, `data_import.sql`.
   - Графические файлы: `res/logo.png`, `res/icon.ico`.
   - Исполняемый файл: `sqlite3.exe`.
5. Создайте базу данных:
   ```bash
   sqlite3 wallpaper_company.db < schema.sql
   sqlite3 wallpaper_company.db < schema2.sql
   sqlite3 wallpaper_company.db < data.sql
   sqlite3 wallpaper_company.db < data_import.sql
   ```
6. Запустите приложение:
   ```bash
   python main.py
   ```

## Использование

### Главное окно
- **Список продукции:** Отображает все продукты с типом, наименованием, артикулом, минимальной стоимостью, шириной рулона и рассчитанной стоимостью.
- **Кнопка "Добавить продукт":** Открывает форму для добавления нового продукта.

### Форма добавления/редактирования
- **Поля:** Артикул, тип продукта (выпадающий список), наименование, минимальная стоимость, ширина рулона.
- **Валидация:** Поля не могут быть пустыми, стоимость и ширина должны быть неотрицательными.
- **Кнопка "Сохранить":** Сохраняет изменения и обновляет список.
- **Кнопка "Отмена":** Закрывает форму без сохранения.

### Окно материалов
- **Таблица материалов:** Показывает материалы, используемые продуктом (наименование, требуемое количество).
- **Выбор материала:** Кликните на строку в таблице, чтобы выбрать материал для расчета.
- **Форма расчета:**
  - Количество продукции: Сколько единиц продукции нужно произвести.
  - Параметр 1, Параметр 2: Например, длина и ширина (в метрах).
  - Количество на складе: Автоматически заполняется из базы данных для выбранного материала.
- **Кнопка "Рассчитать":** Вычисляет необходимое количество материала с учетом процента брака и текущего запаса.
- **Кнопка "Назад":** Закрывает окно.

## Структура проекта

- **`main.py`:** Основной файл приложения, содержит интерфейс и логику работы.
- **`material_calc.py`:** Модуль для расчета количества материала (функция `calculate_material_quantity`).
- **`wallpaper_company.db`:** База данных SQLite.
- **`schema.sql`, `schema2.sql`:** Скрипты создания структуры базы данных.
- **`data.sql`, `data_import.sql`:** Скрипты для импорта данных из CSV.
- **`res/logo.png`, `res/icon.ico`:** Графические файлы для логотипа и иконки приложения.

## Описание базы данных

База данных (`wallpaper_company.db`) содержит следующие таблицы:
- `product_type`: Типы продукции (например, "Обои", "Флизелиновые обои") с коэффициентом для расчета.
- `material_type`: Типы материалов (например, "Бумага", "Краска") с процентом брака.
- `material`: Материалы (наименование, цена, запас на складе).
- `product`: Продукты (артикул, тип, наименование, минимальная стоимость, ширина рулона).
- `product_material`: Связь продуктов и материалов (требуемое количество материала для продукта).

Схема соответствует 3-й нормальной форме с первичными и внешними ключами.

## Метод расчета количества материала

Функция `calculate_material_quantity` (в `material_calc.py`):
- **Входные параметры:**
  - `product_type_id`: Тип продукции (для получения коэффициента).
  - `material_id`: Идентификатор материала (для получения процента брака и запаса).
  - `product_quantity`: Количество продукции.
  - `param1`, `param2`: Параметры (например, длина и ширина).
  - `stock_quantity`: Количество материала на складе.
- **Логика:**
  1. Базовое количество: `param1 * param2 * coefficient`.
  2. Учет брака: `base_quantity * (1 + defect_rate)`.
  3. Общее количество: `adjusted_quantity * product_quantity`.
  4. Требуемое количество: `ceil(total_quantity - stock_quantity)`.
- **Результат:** Возвращает целое число (необходимое количество материала) или -1 при ошибке.

## Тестирование

- Приложение протестировано на корректность:
  - Добавление/редактирование продукции.
  - Просмотр материалов.
  - Расчет количества материала с разными входными данными.
- Обработаны исключения:
  - Пустые поля.
  - Отрицательные значения.
  - Некорректные числовые данные.

## Ограничения и возможные улучшения

- Нет ER-диаграммы (нужно создать в формате PDF с помощью СУБД, например, SQLiteStudio).
- Отсутствует автоматическое тестирование (например, юнит-тесты).
- Параметры `param1` и `param2` вводятся вручную; можно привязать их к характеристикам продукта (например, `roll_width`).
- Интерфейс можно улучшить, добавив всплывающие подсказки для полей.

## Авторы

Разработано в рамках демонстрационного экзамена, 2025 год.